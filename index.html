<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8">
<title>Nuestra Galaxia ðŸ’–</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
html,body{
  margin:0;
  padding:0;
  overflow:hidden;
  background:black;
  font-family:Arial, sans-serif;
}

/* BOTÃ“N PLAY */
#playBtn{
  position:fixed;
  bottom:25px;
  left:50%;
  transform:translateX(-50%);
  padding:14px 26px;
  font-size:18px;
  border:none;
  border-radius:40px;
  background:#ff6fa5;
  color:white;
  cursor:pointer;
  box-shadow:0 0 25px #ff9cc7;
  z-index:10;
}

#playBtn:hover{
  transform:translateX(-50%) scale(1.05);
}

canvas{display:block}
</style>
</head>

<body>

<button id="playBtn">ðŸ’– Reproducir</button>

<audio id="audio" loop>
  <source src="amor.mp3" type="audio/mpeg">
</audio>

<canvas id="c"></canvas>

<script src="https://cdn.jsdelivr.net/npm/three@0.148.0/build/three.min.js"></script>

<script>
/* AUDIO */
const audio=document.getElementById("audio");
const playBtn=document.getElementById("playBtn");

playBtn.onclick=()=>{
  audio.play();
  playBtn.style.display="none";
};

/* THREE */
const canvas=document.getElementById("c");
const renderer=new THREE.WebGLRenderer({canvas, antialias:true});
renderer.setSize(innerWidth, innerHeight);
renderer.setPixelRatio(Math.min(devicePixelRatio,2));

const scene=new THREE.Scene();
const camera=new THREE.PerspectiveCamera(60, innerWidth/innerHeight, 1, 4000);
camera.position.z=300;

/* LUZ */
scene.add(new THREE.AmbientLight(0xffffff,1));

/* ESTRELLAS */
const starGeo=new THREE.BufferGeometry();
const starCount=2000;
const starPos=new Float32Array(starCount*3);

for(let i=0;i<starCount;i++){
  const r=1500*Math.random();
  const a=Math.random()*Math.PI*2;
  const b=Math.acos(2*Math.random()-1);
  starPos[i*3]=r*Math.sin(b)*Math.cos(a);
  starPos[i*3+1]=r*Math.cos(b);
  starPos[i*3+2]=r*Math.sin(b)*Math.sin(a);
}

starGeo.setAttribute("position",new THREE.BufferAttribute(starPos,3));
scene.add(new THREE.Points(
  starGeo,
  new THREE.PointsMaterial({size:1.4,color:0xffffff})
));

/* CARGA TEXTURAS */
const loader=new THREE.TextureLoader();

/* FOTO CENTRAL */
const centerMat=new THREE.SpriteMaterial({
  map:loader.load("centro.jpg"),
  depthTest:false
});
const center=new THREE.Sprite(centerMat);
center.scale.set(130,130,1);
center.position.set(0,0,0);
center.renderOrder=10;
scene.add(center);

/* FOTOS ORBITANDO */
const fotos=[];

["foto1.jpg","foto2.jpg"].forEach((img,i)=>{
  const mat=new THREE.SpriteMaterial({
    map:loader.load(img),
    depthTest:false
  });
  const s=new THREE.Sprite(mat);
  s.scale.set(90,65,1);
  s.userData={
    angle:Math.random()*Math.PI*2,
    radius:190+40*i,
    speed:0.002+0.001*i
  };
  s.position.y=30-i*60;
  s.renderOrder=5;
  scene.add(s);
  fotos.push(s);
});

/* ANIMACIÃ“N */
let t=0;
function animate(){
  requestAnimationFrame(animate);
  t+=0.01;

  /* latido con mÃºsica */
  const beat=audio.paused ? Math.sin(t*2) : Math.sin(audio.currentTime*2);
  const pulse=1+0.08*Math.abs(beat);
  center.scale.set(130*pulse,130*pulse,1);

  /* Ã³rbitas */
  fotos.forEach(f=>{
    f.userData.angle+=f.userData.speed;
    f.position.x=f.userData.radius*Math.cos(f.userData.angle);
    f.position.z=f.userData.radius*Math.sin(f.userData.angle);
  });

  camera.position.x=Math.sin(t*0.3)*20;
  camera.lookAt(0,0,0);

  renderer.render(scene,camera);
}
animate();

/* RESIZE */
addEventListener("resize",()=>{
  camera.aspect=innerWidth/innerHeight;
  camera.updateProjectionMatrix();
  renderer.setSize(innerWidth,innerHeight);
});
</script>

</body>
</html>
