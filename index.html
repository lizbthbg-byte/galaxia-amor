<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8">
<title>Galaxia del Amor ğŸ’–</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
html,body{
  margin:0;
  padding:0;
  overflow:hidden;
  background:#000;
  font-family:Arial, sans-serif;
}
canvas{display:block}
#playBtn{
  position:fixed;
  bottom:22px;
  left:50%;
  transform:translateX(-50%);
  padding:14px 30px;
  font-size:18px;
  border:none;
  border-radius:999px;
  background:transparent;
  color:white;
  cursor:pointer;
  box-shadow:0 0 15px #ff6600,0 0 30px #ff3300;
  border:2px solid #ff6600;
  z-index:100;
}
</style>
</head>

<body>

<button id="playBtn">ğŸ’– Reproducir</button>

<audio id="audio" loop>
  <source src="amor.mp3" type="audio/mpeg">
</audio>

<canvas id="c"></canvas>

<script src="https://cdn.jsdelivr.net/npm/three@0.148.0/build/three.min.js"></script>

<script>
/* AUDIO */
const audio=document.getElementById("audio");
playBtn.onclick=()=>{
  audio.play();
  playBtn.style.display="none";
};

/* THREE */
const renderer=new THREE.WebGLRenderer({canvas:c,antialias:true});
renderer.setSize(innerWidth,innerHeight);
renderer.setPixelRatio(Math.min(devicePixelRatio,2));

const scene=new THREE.Scene();
const camera=new THREE.PerspectiveCamera(60,innerWidth/innerHeight,0.1,8000);
let targetDist=300, currentDist=300;
scene.add(new THREE.AmbientLight(0xffffff,1));

/* ZOOM */
addEventListener("wheel",e=>{
  targetDist+=e.deltaY*0.25;
  targetDist=Math.max(160,Math.min(600,targetDist));
});

/* ESTRELLAS */
(()=>{
  const g=new THREE.BufferGeometry();
  const p=new Float32Array(2400*3);
  for(let i=0;i<2400;i++){
    const r=2000*(0.3+0.7*Math.random());
    const a=Math.random()*Math.PI*2;
    const b=Math.acos(2*Math.random()-1);
    p[i*3]=r*Math.sin(b)*Math.cos(a);
    p[i*3+1]=r*Math.cos(b);
    p[i*3+2]=r*Math.sin(b)*Math.sin(a);
  }
  g.setAttribute("position",new THREE.BufferAttribute(p,3));
  scene.add(new THREE.Points(g,new THREE.PointsMaterial({
    size:1.5,
    color:0xffffff,
    depthWrite:false
  })));
})();

/* TEXTURAS */
const loader=new THREE.TextureLoader();

/* CENTRO (FOTO) */
const center=new THREE.Sprite(
  new THREE.SpriteMaterial({
    map:loader.load("centro.jpg"),
    transparent:true,
    depthWrite:false
  })
);
center.scale.set(140,140,1);
center.renderOrder=50;
scene.add(center);

/* HUMO / GLOW NARANJA */
function makeGlow(size=768){
  const c=document.createElement("canvas");
  c.width=c.height=size;
  const ctx=c.getContext("2d");
  const g=ctx.createRadialGradient(
    size/2,size/2,size*0.05,
    size/2,size/2,size*0.5
  );
  g.addColorStop(0,"rgba(255,180,80,0.9)");
  g.addColorStop(0.5,"rgba(255,120,0,0.6)");
  g.addColorStop(1,"rgba(0,0,0,0)");
  ctx.fillStyle=g;
  ctx.fillRect(0,0,size,size);
  return new THREE.CanvasTexture(c);
}

const glow=new THREE.Sprite(
  new THREE.SpriteMaterial({
    map:makeGlow(),
    transparent:true,
    depthWrite:false
  })
);
glow.scale.set(520,520,1);
scene.add(glow);

/* ANILLOS TIPO SATURNO */
function ringTexture(size=768){
  const c=document.createElement("canvas");
  c.width=c.height=size;
  const ctx=c.getContext("2d");
  ctx.translate(size/2,size/2);
  const g=ctx.createRadialGradient(0,0,size*0.2,0,0,size*0.45);
  g.addColorStop(0,"rgba(255,220,180,1)");
  g.addColorStop(0.4,"rgba(255,160,80,0.8)");
  g.addColorStop(0.7,"rgba(255,80,0,0.6)");
  g.addColorStop(1,"rgba(0,0,0,0)");
  ctx.fillStyle=g;
  ctx.beginPath();
  ctx.arc(0,0,size*0.45,0,Math.PI*2);
  ctx.arc(0,0,size*0.28,0,Math.PI*2,true);
  ctx.fill();
  return new THREE.CanvasTexture(c);
}

const ringMat=new THREE.MeshBasicMaterial({
  map:ringTexture(),
  transparent:true,
  side:THREE.DoubleSide
});
const ring1=new THREE.Mesh(new THREE.RingGeometry(70,90,128),ringMat);
const ring2=new THREE.Mesh(new THREE.RingGeometry(95,115,128),ringMat);
ring1.rotation.x=ring2.rotation.x=Math.PI/2;
ring2.material.opacity=0.6;
scene.add(ring1,ring2);

/* FOTOS ORBITANDO */
const fotos=[];
["foto1.jpg","foto2.jpg"].forEach((img,i)=>{
  const s=new THREE.Sprite(new THREE.SpriteMaterial({
    map:loader.load(img),
    transparent:true,
    depthWrite:false
  }));
  s.scale.set(100,70,1);
  s.userData={a:i*Math.PI,r:230,vel:0.002+(i*0.001)};
  scene.add(s);
  fotos.push(s);
});

/* FRASES MASIVAS (MISMA LÃ“GICA DEL ORIGINAL) */
const frasesBase=[
 "Mi solecito","Te quiero","Siempre tÃº","Nuestro gatito ğŸ±",
 "Eres luz","Eres hogar","Mi universo","âœ¨","ğŸ’–","ğŸŒ™","ğŸŒ¸","ğŸ’«"
];

const textos=[];
for(let i=0;i<120;i++){
  const txt=frasesBase[Math.floor(Math.random()*frasesBase.length)];
  const c=document.createElement("canvas");
  c.width=512;c.height=128;
  const ctx=c.getContext("2d");
  ctx.font="bold 60px Arial";
  ctx.fillStyle="#fff";
  ctx.textAlign="center";
  ctx.textBaseline="middle";
  ctx.shadowColor="#ff9966";
  ctx.shadowBlur=30;
  ctx.fillText(txt,256,64);

  const s=new THREE.Sprite(new THREE.SpriteMaterial({
    map:new THREE.CanvasTexture(c),
    transparent:true
  }));
  s.scale.set(50,16,1);

  const phi=Math.acos(2*Math.random()-1);
  const theta=Math.random()*Math.PI*2;
  const r=150+120*Math.random();
  s.position.set(
    r*Math.sin(phi)*Math.cos(theta),
    r*Math.cos(phi),
    r*Math.sin(phi)*Math.sin(theta)
  );
  s.userData={phi,theta,r,speed:0.001+0.001*Math.random()};
  scene.add(s);
  textos.push(s);
}

/* ANIMACIÃ“N (MISMA VELOCIDAD DEL ORIGINAL) */
let t=0;
function animate(){
  requestAnimationFrame(animate);
  t+=0.01;

  ring1.rotation.z+=0.002;
  ring2.rotation.z-=0.0015;

  glow.scale.setScalar(520*(1+0.03*Math.sin(0.4*t)));

  fotos.forEach(f=>{
    f.userData.a+=f.userData.vel;
    f.position.set(
      f.userData.r*Math.cos(f.userData.a),
      30,
      f.userData.r*Math.sin(f.userData.a)
    );
  });

  textos.forEach(s=>{
    s.userData.theta+=s.userData.speed;
    s.position.x=s.userData.r*Math.sin(s.userData.phi)*Math.cos(s.userData.theta);
    s.position.z=s.userData.r*Math.sin(s.userData.phi)*Math.sin(s.userData.theta);
  });

  currentDist+=0.06*(targetDist-currentDist);
  camera.position.set(
    currentDist*Math.sin(0.2*t),
    currentDist*0.2*Math.sin(0.3*t),
    currentDist*Math.cos(0.2*t)
  );
  camera.lookAt(0,0,0);
  renderer.render(scene,camera);
}
animate();
</script>

</body>
</html>
