<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8">
<title>Nuestra Galaxia ğŸ’–</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
html,body{
  margin:0;
  padding:0;
  overflow:hidden;
  background:black;
  font-family:Arial, sans-serif;
}
canvas{display:block}
#playBtn{
  position:fixed;
  bottom:24px;
  left:50%;
  transform:translateX(-50%);
  padding:14px 28px;
  font-size:18px;
  border:none;
  border-radius:40px;
  background:#ff6fa5;
  color:white;
  cursor:pointer;
  box-shadow:0 0 25px #ff9cc7;
  z-index:50;
}
</style>
</head>

<body>

<button id="playBtn">ğŸ’– Reproducir</button>

<audio id="audio" loop>
  <source src="amor.mp3" type="audio/mpeg">
</audio>

<canvas id="c"></canvas>

<script src="https://cdn.jsdelivr.net/npm/three@0.148.0/build/three.min.js"></script>

<script>
/* AUDIO */
const audio=document.getElementById("audio");
playBtn.onclick=()=>{
  audio.play();
  playBtn.style.display="none";
};

/* THREE */
const canvas=document.getElementById("c");
const renderer=new THREE.WebGLRenderer({canvas,antialias:true});
renderer.setSize(innerWidth,innerHeight);
renderer.setPixelRatio(Math.min(devicePixelRatio,2));

const scene=new THREE.Scene();
const camera=new THREE.PerspectiveCamera(60,innerWidth/innerHeight,1,6000);
camera.position.z=360;
scene.add(new THREE.AmbientLight(0xffffff,1));

/* ZOOM RUEDA */
addEventListener("wheel",e=>{
  camera.position.z+=e.deltaY*0.2;
  camera.position.z=Math.max(180,Math.min(800,camera.position.z));
});

/* ESTRELLAS */
const starGeo=new THREE.BufferGeometry();
const starPos=new Float32Array(2400*3);
for(let i=0;i<2400;i++){
  const r=1800*Math.random();
  const a=Math.random()*Math.PI*2;
  const b=Math.acos(2*Math.random()-1);
  starPos[i*3]=r*Math.sin(b)*Math.cos(a);
  starPos[i*3+1]=r*Math.cos(b);
  starPos[i*3+2]=r*Math.sin(b)*Math.sin(a);
}
starGeo.setAttribute("position",new THREE.BufferAttribute(starPos,3));
scene.add(new THREE.Points(
  starGeo,
  new THREE.PointsMaterial({size:1.3,color:0xffffff})
));

/* IMÃGENES */
const loader=new THREE.TextureLoader();

/* CENTRO */
const center=new THREE.Sprite(new THREE.SpriteMaterial({
  map:loader.load("centro.jpg"),
  depthTest:false
}));
center.scale.set(150,150,1);
center.renderOrder=30;
scene.add(center);

/* FOTOS ORBITANDO */
const fotos=[];
["foto1.jpg","foto2.jpg"].forEach((img,i)=>{
  const s=new THREE.Sprite(new THREE.SpriteMaterial({
    map:loader.load(img),
    depthTest:false
  }));
  s.scale.set(100,70,1);
  s.userData={a:i*Math.PI,r:220,vel:0.002+(i*0.001)};
  s.position.y=30;
  s.renderOrder=20;
  scene.add(s);
  fotos.push(s);
});

/* FRASES ABUNDANTES (LLUVIA ROMÃNTICA) */
const frasesBase=[
 "Solecito","Te quiero","Siempre tÃº","Nuestro gatito ğŸ±","Contigo",
 "Mi lugar","Nuestro universo","AquÃ­ contigo","Para siempre",
 "Eres hogar","âœ¨","ğŸ’–","ğŸŒ™","ğŸŒ¸","ğŸ’«"
];

const textos=[];
for(let i=0;i<40;i++){   // MUCHAS FRASES
  const txt=frasesBase[Math.floor(Math.random()*frasesBase.length)];

  const c=document.createElement("canvas");
  c.width=512; c.height=256;
  const ctx=c.getContext("2d");
  ctx.font="bold 56px Arial";
  ctx.fillStyle="#ffffff";
  ctx.textAlign="center";
  ctx.textBaseline="middle";
  ctx.shadowColor="#ff6fa5";
  ctx.shadowBlur=30;
  ctx.fillText(txt,256,128);

  const spr=new THREE.Sprite(new THREE.SpriteMaterial({
    map:new THREE.CanvasTexture(c),
    transparent:true,
    depthTest:false
  }));

  spr.scale.set(150+Math.random()*40,70,1);
  spr.userData={
    a:Math.random()*Math.PI*2,
    r:200+Math.random()*400,
    vel:0.0004+Math.random()*0.001,
    h:-120+Math.random()*240
  };
  spr.renderOrder=40;
  scene.add(spr);
  textos.push(spr);
}

/* ANIMACIÃ“N */
let t=0;
function animate(){
  requestAnimationFrame(animate);
  t+=0.01;

  const beat=audio.paused?Math.sin(t*2):Math.sin(audio.currentTime*2);
  const pulse=1+0.08*Math.abs(beat);
  center.scale.set(150*pulse,150*pulse,1);

  fotos.forEach(f=>{
    f.userData.a+=f.userData.vel;
    f.position.x=f.userData.r*Math.cos(f.userData.a);
    f.position.z=f.userData.r*Math.sin(f.userData.a);
  });

  textos.forEach(s=>{
    s.userData.a+=s.userData.vel;
    s.position.set(
      s.userData.r*Math.cos(s.userData.a),
      s.userData.h + Math.sin(t*0.8)*20,
      s.userData.r*Math.sin(s.userData.a)
    );
  });

  camera.lookAt(0,0,0);
  renderer.render(scene,camera);
}
animate();

/* RESIZE */
addEventListener("resize",()=>{
  camera.aspect=innerWidth/innerHeight;
  camera.updateProjectionMatrix();
  renderer.setSize(innerWidth,innerHeight);
});
</script>

</body>
</html>
